[TOC]

#面向BSP模型的基于边聚簇特性的大图划分与迭代处理
简介
---
- Hadoop不适合迭代式的处理图的数据:**因为图数据中并行化数据的缺失**
- 基于BSP的解决方案-pregel,hama,聚簇边列表GELiraph: 但是要频繁交换中间计算结果

> **对图数据进行有效划分**是降低跨分区消息规模的有效手段 
> **Hash划分**:严重破坏原数据的拓扑结构且增加了巨大的通信开销,仍然采用**可改进!**
> **其他划分**: GPS: graph processing system; GAS; Powergraph

##解决问题
> **降低分区之间的通信量**以降低网络负载

##创新点
1. 基于边聚簇的垂直混合划分策略(EC-VHP):对邻接表进行hash水平划分和边聚簇垂直混合划分,建立代价收益模型
	1. 用**Hash水平划分**保证数据划分的简单高效
	2. 用**边聚簇垂直划分保证降低消息通信规模**
	3. 聚簇边路由: 路由压缩,多条边消息的路由计算压缩成单个聚簇边路由的信息
2. 在EC-VHP的基础上提出了**点-边计算模型**
3. 设计**简单Hash索引**和**多队列并行顺序索引机制**

##核心思想
> 1. 在划分过程中**目的顶点邻接表中的多条边**可按照**目的顶点所在数据分区进行聚簇**的特性

###BC-BSP系统
1. 以**邻接表格式组织**,如图:<br>![](http://i.imgur.com/awf7u6I.jpg)
2. 系统结构图:<br>![](http://i.imgur.com/DfKyvVp.jpg)

##基于边聚簇的垂直混合划分--对计算负载的迁移
###划分策略:
> - **聚簇边**:就是**按照某一种顶点的边聚簇映射约束产生的**边集合的划分: **顶点出边的划分**,

> - **垂直混合划分**:
> - 对于每个顶点v,对于它的聚簇边集里的每个元素(是一个边集),如果边的个数超过一个**阈值**,就把该元素(边集)分配给一个任务(任务划分集合)**(聚簇边到任务的映射)**,同时创建**聚簇边列表GEL (v,E) clustered edges list**: 
> - **垂直混合划分对聚簇边进行重新分配**. 相当于用聚簇减少点集的规模.
> - 将平均初读为|E|/|V|的图划分到p个任务上,**若p小于平均出度,则降低越明显**
> - **聚簇边路由**:
> 		- 指明维护聚簇边的**目的任务分区**,顶点v到任务分区的聚簇边路由:CER(Clustered edges router).
> 		- 对于顶点的聚簇边划分集的任务分配.--就是处理一个顶点的聚簇边集需要哪些任务

1. 算法流程,<br>
![](http://i.imgur.com/TVLSDda.jpg)
2. 效果图<br>
![](http://i.imgur.com/sEGb9b9.jpg)

###计算模型
1. **点-边模型**流程为<br>![](http://i.imgur.com/VZUHoEN.jpg)
	1. 点计算(边消息)-->(边消息,聚簇边消息) **边消息**是指原图中的边
	2. 边计算(聚簇边消息)-->(边消息)(聚簇边重新分配)
	3. 点计算...
2. 点边模型下的**单源最短路径**:每次迭代时
	1. **点计算中**每个顶点先接受来自**入度边**的相邻顶点的消息,找出最小值并更新
	2. 同时向该顶点的**出度相邻点**发出**边消息**和**聚簇边消息**
	3. 相邻顶点
		1. 若接收到的是**边消息**,直接加入边消息序列,准备下一次处理
		2. 若接收到的是**聚簇边消息**,利用**边计算**生成**边消息**再加入下一次计算.

###代价收益模型与阈值分析(?数学推导)
1. **阈值的选取**对性能的影响非常紧密
2. 垂直划分直方图:**满足划分阈值的聚簇边进行排序分组**
3. 垂直划分的i级直方图:**聚簇边集有i条边的集合的个数**

##并行点-边计算模型与索引机制
> 将本地计算任务的部分计算负载迁移到消息接收过程中进行处理

> **在消息接收过程中,即顶点判断是边消息还是聚簇边消息**
> **系统对聚簇边消息的处理**

1. 串行集中式--串行扫描(serial scan): **要等到点计算结束才能进入边计算** 需要加入处理队列等待
2. 并行的即时计算 **收到聚簇边消息后,马上进行边计算**
	1. 聚簇边消息接收线程
	2. 要在数据划分时对聚簇边建立查询索引
		- PHI:并行hash索引
		- PSI:并行顺序索引,**聚簇边有序的多队列并行顺序索引的机制**
			- 根据聚簇边消息的PID值在PSI结构中找到对应的聚**簇边分区队列**.
			- 要保证**数据划分时聚簇边重划分的顺序**与**迭代计算时边的顺序**一致: 才能查找次数最少
			- 然后**从队列获得当前的聚簇边指针**
			1. 

##further reading
1. 任务分区:**每个数据分区交给不同的任务worker**
